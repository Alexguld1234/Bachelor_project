I am building a deep learning model that takes an image as input and generates a free-text report as output (for example, medical X-ray reports).

I need your help with the following tasks:

1. Text Preprocessing

Tokenize the text reports (simple whitespace- or punctuation-based tokenization is enough).

Build a vocabulary from the dataset.

Map each token to a unique integer ID (create token2id and id2token dictionaries).

Include special tokens like <start>, <end>, <pad>, and <unk>.

Make the code modular, clean, and easy to integrate with a PyTorch model.

Provide a small example where a few sample sentences are tokenized and vocab is built.

2. Metrics for Evaluation

During training, use Cross-Entropy Loss at each decoding step.

After training, evaluate the text generation using these metrics:

BLEU (BLEU-1 to BLEU-4)

ROUGE (ROUGE-1, ROUGE-2, ROUGE-L)

METEOR

CIDEr

BERTScore

3. Visualization Ideas

For Metrics (BLEU, ROUGE, METEOR, CIDEr, BERTScore):

Line plots over epochs showing metric scores.

Bar plots comparing final scores across metrics.

Radar (spider) charts to visualize overall model performance.

Heatmaps showing correlations between different metrics.

Box plots or violin plots showing distribution of metric scores over all samples.

Histogram of CIDEr or BERTScore across examples.

Specific to Each Metric:

Plot BLEU-1, BLEU-2, BLEU-3, BLEU-4 separately over epochs.

Plot ROUGE-1, ROUGE-2, ROUGE-L separately.

Scatter plot of METEOR vs BLEU scores to compare differences.

For Free-Text Generation Visualization:

Display image + generated report + true report side-by-side.

Highlight differences between generated and true report (e.g., color correct words green, wrong words red).

Show BLEU/ROUGE scores next to each generated report.

Attention heatmaps (if the model uses attention) showing where the model "looks" while generating.

Word clouds from generated text across the dataset.

Animate text generation word-by-word (optional, for presentations).

4. Bonus

If possible, also suggest how to log all metrics, generated text, and images automatically during training using either TensorBoard or Weights & Biases (wandb).